# ëŒ€ìš©ëŸ‰ ë°ì´í„° ê°€ê³µí•˜ê¸°

### 1ï¸âƒ£ ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ School ê°ì²´ë¡œ ë§Œë“¤ê¸° (String í´ë˜ìŠ¤ì˜ Split() ë©”ì„œë“œ í™œìš©)

âœ” ì†ŒìŠ¤ì½”ë“œ (SchoolParser.java, SchoolParserTest.java)

ğŸ‘‡ SchoolParser.java

```java
package com.bigdata.parser;

import com.bigdata.domain.School;

import java.time.LocalDateTime;
import java.util.Arrays;

public class SchoolParser implements Parser<School>{

    @Override
    public School parse(String str) {
        String[] splitted = str.split(",");
        System.out.println(Arrays.toString(splitted));
        String date = splitted[3];
        int year = Integer.parseInt(date.substring(0, 4));
        int month = Integer.parseInt(date.substring(5, 7));
        int day = Integer.parseInt(date.substring(8));
        boolean isMainSchool = (splitted[5].equals("ë³¸êµ")) ? true : false;
        return new School(splitted[0], splitted[1], splitted[2], LocalDateTime.of(year, month, day,0, 0, 0), splitted[4], isMainSchool, splitted[6],splitted[7], splitted[8], splitted[9], splitted[10], splitted[11], splitted[12], Double.parseDouble(splitted[15]), Double.parseDouble(splitted[16]));
    }
}
```

ğŸ‘‡ SchoolParserTest.java

```java
package com.bigdata.parser;

import com.bigdata.domain.School;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import java.time.LocalDateTime;

import static org.junit.jupiter.api.Assertions.*;

class SchoolParserTest {
    SchoolParser schoolParser;

    @Test
    @DisplayName("ì›í•˜ëŠ” í˜•íƒœë¡œ ë°ì´í„°ê°€ ì˜ ë¶„ë¦¬ë˜ì–´ ë°°ì—´ì— ì €ì¥ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸")
    public void splitTest() {
        schoolParser = new SchoolParser();
        String line = "B000003406,ëŒ€ì „ë¹„ë˜ì´ˆë“±í•™êµ,ì´ˆë“±í•™êµ,2005-03-01,ê³µë¦½,ë³¸êµ,ìš´ì˜,ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ 245-1,ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìš°ì•”ë¡œ492ë²ˆì•ˆê¸¸ 65,7430000,ëŒ€ì „ê´‘ì—­ì‹œêµìœ¡ì²­,7441000,ëŒ€ì „ê´‘ì—­ì‹œë™ë¶€êµìœ¡ì§€ì›ì²­,2013-11-29,2021-07-05,36.363531243,127.45289438,2021-09-15,7001220,í•œêµ­êµì›ëŒ€í•™êµ";
        School school = schoolParser.parse(line);
        assertEquals("B000003406", school.getId());
        assertEquals("ëŒ€ì „ë¹„ë˜ì´ˆë“±í•™êµ", school.getName());
        assertEquals(LocalDateTime.of(2005, 03, 01, 0, 0, 0), school.getAnniversary());
        assertEquals("ê³µë¦½", school.getEstablishForm());
        assertTrue(school.getMainSchool());
        assertEquals("ìš´ì˜", school.getOperationalStatus());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ 245-1", school.getJiBunAddress());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìš°ì•”ë¡œ492ë²ˆì•ˆê¸¸ 65", school.getRoadNameAddress());
        assertEquals("7430000", school.getSidoOfficeOfEducationCode());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œêµìœ¡ì²­", school.getSidoOfficeOfEducation());
        assertEquals("7441000", school.getSmallOfficeOfEducationCode());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œë™ë¶€êµìœ¡ì§€ì›ì²­", school.getSmallOfficeOfEducation());
        assertEquals(36.363531243, school.getLatitude());
        assertEquals(127.45289438, school.getLongitude());
    }
}
```

<br />

**ğŸ’¡ ì‹¤í–‰ ê²°ê³¼**

![image-20221106000328789](./assets/image-20221106000328789.png)

<br />

<br />

### 2ï¸âƒ£ School ê°ì²´ë¥¼ ì´ìš©í•œ SQL INSERT ì¿¼ë¦¬ë¬¸ ì‘ì„±í•˜ê¸°

âœ” ì†ŒìŠ¤ì½”ë“œ (School.java, SchoolTest.java)

```java
package com.bigdata.domain;

import java.time.LocalDateTime;

public class School {
    private String id;
    private String name;
    private String grade;
    private LocalDateTime anniversary;
    private String establishForm;
    private boolean mainSchool;
    private String operationalStatus;
    private String jiBunAddress;
    private String roadNameAddress;
    private String sidoOfficeOfEducationCode;
    private String sidoOfficeOfEducation;
    private String smallOfficeOfEducationCode;
    private String smallOfficeOfEducation;
    private Double latitude;  // ìœ„ë„
    private Double longitude;  // ê²½ë„

    public School() {
    }

    public School(String id, String name, String grade, LocalDateTime anniversary, String establishForm, boolean mainSchool, String operationalStatus, String jiBunAddress, String roadNameAddress, String sidoOfficeOfEducationCode, String sidoOfficeOfEducation, String smallOfficeOfEducationCode, String smallOfficeOfEducation, Double latitude, Double longitude) {
        this.id = id;
        this.name = name;
        this.grade = grade;
        this.anniversary = anniversary;
        this.establishForm = establishForm;
        this.mainSchool = mainSchool;
        this.operationalStatus = operationalStatus;
        this.jiBunAddress = jiBunAddress;
        this.roadNameAddress = roadNameAddress;
        this.sidoOfficeOfEducationCode = sidoOfficeOfEducationCode;
        this.sidoOfficeOfEducation = sidoOfficeOfEducation;
        this.smallOfficeOfEducationCode = smallOfficeOfEducationCode;
        this.smallOfficeOfEducation = smallOfficeOfEducation;
        this.latitude = latitude;
        this.longitude = longitude;
    }

    public String getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    public String getGrade() {
        return grade;
    }

    public LocalDateTime getAnniversary() {
        return anniversary;
    }

    public String getEstablishForm() {
        return establishForm;
    }

    public boolean getMainSchool() {
        return mainSchool;
    }

    public String getOperationalStatus() {
        return operationalStatus;
    }

    public String getJiBunAddress() {
        return jiBunAddress;
    }

    public String getRoadNameAddress() {
        return roadNameAddress;
    }

    public String getSidoOfficeOfEducationCode() {
        return sidoOfficeOfEducationCode;
    }

    public String getSidoOfficeOfEducation() {
        return sidoOfficeOfEducation;
    }

    public String getSmallOfficeOfEducationCode() {
        return smallOfficeOfEducationCode;
    }

    public String getSmallOfficeOfEducation() {
        return smallOfficeOfEducation;
    }

    public Double getLatitude() {
        return latitude;
    }

    public Double getLongitude() {
        return longitude;
    }

    public String getSqlInsertQuery() {
        String sql = String.format("INSERT INTO `test-db`.`nation_wide_school`\n" +
                "VALUES\n" +
                "(\"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\",\n" +
                "\"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\")",
                this.id, this.name, this.grade, this.anniversary, this.establishForm, this.mainSchool, this.operationalStatus, this.jiBunAddress,
                this.roadNameAddress, this.sidoOfficeOfEducationCode, this.sidoOfficeOfEducation, this.smallOfficeOfEducationCode, this.smallOfficeOfEducation, this.latitude, this.longitude);
        return sql;
    }

    public String getTupleString() {
        String sql = String.format("(\"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\",\n" +
                "\"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\", \"%s\")",
                this.id, this.name, this.grade, this.anniversary, this.establishForm, this.mainSchool, this.operationalStatus, this.jiBunAddress,
                this.roadNameAddress, this.sidoOfficeOfEducationCode, this.sidoOfficeOfEducation, this.smallOfficeOfEducationCode, this.smallOfficeOfEducation, this.latitude, this.longitude);

        return sql;
    }
}
```

```java
package com.bigdata.parser;

import com.bigdata.domain.School;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import java.time.LocalDateTime;

import static org.junit.jupiter.api.Assertions.*;

class SchoolParserTest {
    SchoolParser schoolParser;

    @Test
    @DisplayName("ì›í•˜ëŠ” í˜•íƒœë¡œ ë°ì´í„°ê°€ ì˜ ë¶„ë¦¬ë˜ì–´ ë°°ì—´ì— ì €ì¥ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸")
    public void splitTest() {
        schoolParser = new SchoolParser();
        String line = "B000003406,ëŒ€ì „ë¹„ë˜ì´ˆë“±í•™êµ,ì´ˆë“±í•™êµ,2005-03-01,ê³µë¦½,ë³¸êµ,ìš´ì˜,ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ 245-1,ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìš°ì•”ë¡œ492ë²ˆì•ˆê¸¸ 65,7430000,ëŒ€ì „ê´‘ì—­ì‹œêµìœ¡ì²­,7441000,ëŒ€ì „ê´‘ì—­ì‹œë™ë¶€êµìœ¡ì§€ì›ì²­,2013-11-29,2021-07-05,36.363531243,127.45289438,2021-09-15,7001220,í•œêµ­êµì›ëŒ€í•™êµ";
        School school = schoolParser.parse(line);
        assertEquals("B000003406", school.getId());
        assertEquals("ëŒ€ì „ë¹„ë˜ì´ˆë“±í•™êµ", school.getName());
        assertEquals(LocalDateTime.of(2005, 03, 01, 0, 0, 0), school.getAnniversary());
        assertEquals("ê³µë¦½", school.getEstablishForm());
        assertTrue(school.getMainSchool());
        assertEquals("ìš´ì˜", school.getOperationalStatus());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ë¹„ë˜ë™ 245-1", school.getJiBunAddress());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œ ëŒ€ë•êµ¬ ìš°ì•”ë¡œ492ë²ˆì•ˆê¸¸ 65", school.getRoadNameAddress());
        assertEquals("7430000", school.getSidoOfficeOfEducationCode());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œêµìœ¡ì²­", school.getSidoOfficeOfEducation());
        assertEquals("7441000", school.getSmallOfficeOfEducationCode());
        assertEquals("ëŒ€ì „ê´‘ì—­ì‹œë™ë¶€êµìœ¡ì§€ì›ì²­", school.getSmallOfficeOfEducation());
        assertEquals(36.363531243, school.getLatitude());
        assertEquals(127.45289438, school.getLongitude());
    }
    
}
```

<br />

**ğŸ’¡ ì‹¤í–‰ ê²°ê³¼**

![image-20221106000227479](./assets/image-20221106000227479.png)

<br />

<br />

### ğŸ“’ ì˜¤ëŠ˜ì˜ íšŒê³ 

ì˜¤ëŠ˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ë‹¤ìŒì˜ ë¬¸ì œì ë“¤ì´ ìˆì–´ School í´ë˜ìŠ¤ë¥¼ ìˆ˜ì •í•  ì¼ì´ ë§ì•˜ë‹¤.

<pre style="border: 1px dotted orange; padding:10px;">
    1. ë°›ì•„ì˜¤ê³ ì í•˜ëŠ” <b>ë°ì´í„°ê°€ ëˆ„ë½</b>ë˜ì—ˆìŒ
	2. ìœ„ë„, ê²½ë„ë¥¼ ë°›ì•„ì˜¤ëŠ” ë°ì´í„° íƒ€ì…ì„ ì˜¨ì „íˆ ë°›ì•„ì˜¤ê¸° ìœ„í•´ <b>Floatì´ ì•„ë‹Œ Double íƒ€ì…ìœ¼ë¡œ ë³€ê²½</b> ë˜ëŠ” 
	   <b>ë°ì´í„° íƒ€ì…ì„ ì˜ëª» ì‘ì„±</b>í•œ ë³€ìˆ˜ê°€ ìˆì–´ ìˆ˜ì •ì´ í•„ìš”í–ˆìŒ
	3. SQL INSERT ë¬¸ì„ ìœ„í•œ 2ê°€ì§€ ë©”ì„œë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë‚´ê°€ ì›í•˜ëŠ” ê²°ê³¼ì— ë§ê²Œ <b>ì •í™•í•œ ë¬¸ìì—´(SQL ì¿¼ë¦¬ë¬¸)ì„ ë°˜í™˜</b>í•˜ë„ë¡
       í•´ì•¼í–ˆìŒ
</pre>


ì´ëŸ¬í•œ ë¬¸ì œì ë“¤ì„ ìœ„í•´ School í´ë˜ìŠ¤ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ìˆ˜ì •í•˜ë©´ì„œ ë§Œì•½ ê°œì¸ í”„ë¡œì íŠ¸ê°€ ì•„ë‹Œ ì‹¤ë¬´ì—ì„œì˜ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ ì˜€ë‹¤ë©´? ì´ë¼ëŠ” ìƒê°ì„ í•´ë³´ì•˜ë‹¤.

ë§Œì•½ ì‹¤ë¬´ì—ì„œ ì €ëŸ° ì‹¤ìˆ˜ë¥¼ í–ˆë‹¤ë©´ ì •ë§ ë”ì°í–ˆì„ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì„ í•˜ê²Œ ë˜ì—ˆë‹¤...ğŸ˜¢

ì•ìœ¼ë¡œëŠ” ì´ëŸ° ì‹¤ìˆ˜ê°€ ì—†ë„ë¡ ì¡°ê¸ˆ ë” ê¼¼ê¼¼í•˜ê²Œ ì„¤ê³„ë¥¼ í•˜ê³  ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ê² ë‹¤.ğŸ”¥

